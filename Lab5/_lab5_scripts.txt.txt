-- ΜΕΡΟΣ Α!
-- Γίνεται χρήση της σχεσιακής βάσης δεδομένων SQLZoo Congestion Charging.
-- 1. Το αυτοκίνητο ή τα αυτοκίνητα που έχουν φωτογραφηθεί ΑΠΟ ΟΛΕΣ τις κάμερες οι οποίες δεν έχουν (ακόμη) χαρακτηριστεί να είναι κάμερες εισόδου (IN) ή κάμερες εξόδου (OUT) στο δακτύλιο.
Απαίτηση: να χρησιμοποιηθεί ο τελεστής EXCEPT (διαφορά συνόλων).
ΑΠΑΝΤΗΣΗ: ΝΑ ΕΛΕΓΧΘΕΙ
SELECT * FROM vehicle v
	WHERE NOT EXISTS
	(SELECT c.id FROM camera c WHERE perim is NULL
	EXCEPT
	SELECT i.camera FROM image i WHERE i.reg = v.id)

-- 2. Το αυτοκίνητο ή τα αυτοκίνητα που έχουν φωτογραφηθεί ΑΠΟ ΟΛΕΣ τις κάμερες οι οποίες δεν έχουν (ακόμη) χαρακτηριστεί να είναι κάμερες εισόδου (IN) ή κάμερες εξόδου (OUT) στο δακτύλιο.
Απαίτηση: να ΜΗΝ χρησιμοποιηθεί ο τελεστής EXCEPT. Να λυθεί με διπλή άρνηση.

-- 3. Το αυτοκίνητο ή τα αυτοκίνητα που έχουν φωτογραφηθεί ΑΠΟ ΟΛΕΣ τις κάμερες οι οποίες δεν έχουν (ακόμη) χαρακτηριστεί να είναι κάμερες εισόδου (IN) ή κάμερες εξόδου (OUT) στο δακτύλιο.
Απαίτηση: να χρησιμοποιηθεί η συνιστώσα σύνταξης GROUP BY … HAVING και να ΜΗΝ χρησιμοποιηθούν οι τελεστές EXCEPT ή/και (NOT) EXISTS

-- 4. Το αυτοκίνητο ή τα αυτοκίνητα που έχουν φωτογραφηθεί ΑΠΟ ΟΛΕΣ τις κάμερες οι οποίες δεν έχουν (ακόμη) χαρακτηριστεί να είναι κάμερες εισόδου (IN) ή κάμερες εξόδου (OUT) στο δακτύλιο.
Απαίτηση: το αποτέλεσμα να υπολογιστεί χωρίς την χρήση των GROUP BY … HAVING ή/και EXCEPT ή/και (NOT) EXISTS



-- ΜΕΡΟΣ Β!
-- Γίνεται χρήση της σχεσιακής βάσης δεδομένων των ναυτικών/σκαφών/μαρίνων
-- 1. Σκάφη των οποίων έχουν γίνει δύο ή περισσότερες κρατήσεις. Να εμφανιστούν ο κωδικός και ο συνολικός αριθμός των κρατήσεων που έχουν γίνει για το κάθε ένα σκάφος.

-- 2. Σκάφη (κωδικός και όνομα) τα οποία νοικιάστηκαν τουλάχιστον δύο φορές το ίδιο έτος.

-- 3. Πλήθος ενοικιάσεων μπλε (‘Blue’) σκαφών ανά έτος, με ταξινόμηση ως προς το έτος, κατά φθίνουσα τάξη.

-- 4. Μαρίνες (κωδικός και όνομα) από τις οποίες έχουν νοικιαστεί/παραληφθεί όλα ανεξαιρέτως τα σκάφη χρώματος κόκκινου ('Red').

-- 5. Οι περισσότερες ενοικιάσεις κόκκινων (‘Red’) σκαφών ανά έτος.
Σημείωση: η άσκηση να λυθεί και με τη δημιουργία κατάλληλης όψης (View).

-- 6. Αριθμός ενοικιάσεων χρώματος σκάφους ανά έτος, με ταξινόμηση ως προς το χρώμα και για το ίδιο χρώμα ως προς το έτος, κατά φθίνουσα τάξη.

-- 7. Χρώμα(-τα) στο(-α) οποίo(-α) αντιστοιχεί το μεγαλύτερο πλήθος ενοικιάσεων σκαφών, γενικά.
Σημείωση: η άσκηση να λυθεί και με τη δημιουργία κατάλληλης όψης (View).

-- 8. Το χρώμα ή τα χρώματα με τις περισσότερες κρατήσεις ανά έτος, σε σχέση με όλα τα υπόλοιπα χρώματα και έτη που καταχωρεί η βάση.
Προσοχή: ζητείται το χρώμα “νικητής” για όλα τα έτη που καταχωρεί η βάση, όχι το χρώμα με τις περισσότερες κρατήσεις στο κάθε ένα έτος.
Σημείωση: η άσκηση να λυθεί και με τη δημιουργία κατάλληλης όψης (View).

-- 9. Να δημιουργηθεί όψη PC με τα στοιχεία των ναυτικών και των σκαφών που αφορούν σε ενοικιάσεις που έχουν γίνει από την μαρίνα με όνομα ‘Πόρτο Καρράς’

-- 10. Χρησιμοποιήστε την παραπάνω όψη PC για να υπολογίσετε το πλήθος των (διακριτών) σκαφών που έχουν φιλοξενηθεί στη μαρίνα ‘Πόρτο Καρράς’.

-- 11. Ομαδοποιήστε το περιεχόμενο της παραπάνω όψης PC ανά ναύτη και δημιουργήστε νέα όψη PCS με το πλήθος των ενοικιάσεων σκαφών που έχει κάνει κάθε ένας ναύτης από την μαρίνα ‘Πόρτο Καρράς’, συμπεριλαμβάνοντας και ναυτικούς οι οποίοι έχουν νοικάσει μηδέν (0) σκάφη από την μαρίνα ‘Πόρτιο Καρράς’.

-- 12. Χρησιμοποιήστε τα παραπάνω (ίσως: δημιουργώντας ακόμη μία όψη) για να υπολογίσετε τα στοιχεία των ναυτικών των οποίων η ηλικία παρουσιάζει τον μεγαλύτερο μέσο αριθμό ενοικιάσεων σκαφών από τη Μαρίνα ‘Πόρτο Καρράς’ . Έχοντας ολοκληρώσει με τη λύση της άσκησης, αναλογιστείτε το βαθμό δυσκολίας που θα χαρακτήριζε την τελευταία στην περίπτωση που δεν ήταν δυνατή η δημιουργία και η χρήση όψεων.

-- 13. Να απαντηθούν τα των παραπάνω ασκήσεων 9,10,11 και 12 χωρίς τη δημιουργία (μόνιμων) όψεων, αλλά με τη χρήση της συνιστώσας σύνταξης WITH…. SELECT… (δηλ. με όψεις βραχείας διάρκειας).

