
-- 1. Να συνταχθεί κώδικας SQL SELECT που υπολογίζει τα στοιχεία του ιδιοκτήτη του οχήματος με κωδικό 'SO 02 PSP'.
SELECT * FROM keeper WHERE id = (SELECT keeper FROM vehicle WHERE id = 'SO 02 PSP')
Ή
SELECT k.id, k.name, k.address FROM keeper AS k 
	JOIN vehicle AS v ON (k.id = v.keeper)
	WHERE v.id = 'SO 02 PSP'

-- 2. Να υπολογιστεί ο αριθμός (πλήθος) των καμερών που καταγράφουν οχήματα που εισέρχονται (ΙΝ) στο δακτύλιο.
SELECT COUNT(c.id) AS "Number of IN cameras" FROM camera AS c WHERE perim = 'IN'

-- 3. Να εμφανιστούν τα στοιχεία των φωτογραφιών που έχει καταγράψει η κάμερα με κωδικό 10 πριν την 28η Φεβρουαρίου 2007.
SELECT * FROM image AS i
	WHERE camera = 10 AND whn < '2007-02-28';

-- 4. Να εμφανιστούν οι αριθμοί κυκλοφορίας των αυτοκινήτων τα οποία φωτογραφήθηκαν και επαναφωτογραφήθηκαν εκ νέου από την ίδια ή από διαφορετικές κάμερα(-ες) μέσα σε διάστημα μικρότερο ή ίσο του ενός λεπτού.

-- 5. Να εμφανιστεί το σύνολο των στοιχείων των ιδιοκτητών οχημάτων των οποίων οι άδειες/πάσσο εκδόθηκαν την 30η Ιανουαρίου 2007, μία μόνον φορά ο κάθε ένας ιδιοκτήτης και ταξινομημένα κατά φθίνουσα τάξη ως προς το όνομα του ιδιοκτήτη.
SELECT DISTINCT k.id, k.name, k.address FROM keeper k
	JOIN vehicle v ON (k.id = v.keeper)
	JOIN permit p ON (v.id = p.reg)
	WHERE p.sdate = '2007-01-30'
	ORDER BY k.name DESC

-- 6. Τα στοιχεία των πολιτών (μία φορά ο κάθε ένας πολίτης στο αποτέλεσμα) οχήματα των οποίων έχουν καταγραφεί και από την κάμερα με κωδικό 2, και από την κάμερα με κωδικό 5. Το αποτέλεσμα να υπολογιστεί με τη χρήση του IN.
SELECT DISTINCT k.id, k.name, k.address FROM keeper k
	JOIN vehicle v ON (k.id = v.keeper)
	JOIN image i ON (v.id = i.reg)
	WHERE i.camera IN (2, 5)
Ή
SELECT DISTINCT k.id, k.name, k.address FROM keeper k
	JOIN vehicle v ON (k.id = v.keeper)
	JOIN image i ON (v.id = i.reg)
	WHERE i.camera = 2 AND k.id IN (SELECT DISTINCT k.id FROM keeper k
			JOIN vehicle v ON (k.id = v.keeper)
			JOIN image i ON (v.id = i.reg)
			WHERE i.camera = 5)

-- 7. Τα στοιχεία των πολιτών (μία φορά ο κάθε ένας πολίτης στο αποτέλεσμα) οχήματα των οποίων έχουν καταγραφεί και από την κάμερα με κωδικό 2, και από την κάμερα με κωδικό 5. Το αποτέλεσμα να υπολογιστεί με τη χρήση του INTERSECT.
SELECT DISTINCT k.id, k.name, k.address FROM keeper k
	JOIN vehicle v ON (k.id = v.keeper)
	JOIN image i ON (v.id = i.reg)
	WHERE i.camera = 2
INTERSECT
SELECT DISTINCT k.id, k.name, k.address FROM keeper k
	JOIN vehicle v ON (k.id = v.keeper)
	JOIN image i ON (v.id = i.reg)
	WHERE i.camera = 5


-- 8
SELECT DISTINCT k.id, k.name, k.address FROM keeper k
	JOIN vehicle v ON (k.id = v.keeper)
	JOIN image i ON (v.id = i.reg)
	WHERE i.camera = 1 AND EXISTS (SELECT DISTINCT k.id FROM keeper k
			JOIN vehicle v ON (k.id = v.keeper)
			JOIN image i ON (v.id = i.reg)
			WHERE i.camera = 5 )
Ή
SELECT DISTINCT k.id, k.name, k.address FROM keeper k
	JOIN vehicle v ON (k.id = v.keeper)
	JOIN image i ON (v.id = i.reg)
	WHERE i.camera = 2 AND EXISTS (SELECT DISTINCT k1.id FROM keeper k1
			JOIN vehicle v ON (k1.id = v.keeper)
			JOIN image i ON (v.id = i.reg)
			WHERE i.camera = 5 AND k.id = k1.id)
