
-- 1
SELECT * FROM keeper WHERE id = (SELECT keeper FROM vehicle WHERE id = 'SO 02 PSP')

-- 2

-- 3

-- 4

-- 5
SELECT DISTINCT k.id, k.name, k.address FROM keeper k
	JOIN vehicle v ON (k.id = v.keeper)
	JOIN permit p ON (v.id = p.reg)
	WHERE p.sdate = '2007-01-30'
	ORDER BY k.name DESC

-- 6
SELECT DISTINCT k.id, k.name, k.address FROM keeper k
	JOIN vehicle v ON (k.id = v.keeper)
	JOIN image i ON (v.id = i.reg)
	WHERE i.camera IN (1, 2, 5)
Ή
SELECT DISTINCT k.id, k.name, k.address FROM keeper k
	JOIN vehicle v ON (k.id = v.keeper)
	JOIN image i ON (v.id = i.reg)
	WHERE i.camera = 2 AND k.id IN (SELECT DISTINCT k.id FROM keeper k
			JOIN vehicle v ON (k.id = v.keeper)
			JOIN image i ON (v.id = i.reg)
			WHERE i.camera = 5)

-- 7
SELECT DISTINCT k.id, k.name, k.address FROM keeper k
	JOIN vehicle v ON (k.id = v.keeper)
	JOIN image i ON (v.id = i.reg)
	WHERE i.camera = 2
INTERSECT
SELECT DISTINCT k.id, k.name, k.address FROM keeper k
	JOIN vehicle v ON (k.id = v.keeper)
	JOIN image i ON (v.id = i.reg)
	WHERE i.camera = 5


-- 8
SELECT DISTINCT k.id, k.name, k.address FROM keeper k
	JOIN vehicle v ON (k.id = v.keeper)
	JOIN image i ON (v.id = i.reg)
	WHERE i.camera = 1 AND EXISTS (SELECT DISTINCT k.id FROM keeper k
			JOIN vehicle v ON (k.id = v.keeper)
			JOIN image i ON (v.id = i.reg)
			WHERE i.camera = 5 )
Ή
SELECT DISTINCT k.id, k.name, k.address FROM keeper k
	JOIN vehicle v ON (k.id = v.keeper)
	JOIN image i ON (v.id = i.reg)
	WHERE i.camera = 2 AND EXISTS (SELECT DISTINCT k1.id FROM keeper k1
			JOIN vehicle v ON (k1.id = v.keeper)
			JOIN image i ON (v.id = i.reg)
			WHERE i.camera = 5 AND k.id = k1.id)
